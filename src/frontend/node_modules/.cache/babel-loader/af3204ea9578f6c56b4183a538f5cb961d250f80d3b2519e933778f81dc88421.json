{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.unshift.js\";\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n    m = s && o[s],\n    i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n  return ar;\n};\nimport { Scene } from '../scene/scene';\nimport { Group } from '../scene/group';\nimport { SeriesNodePickMode } from './series/series';\nimport { Padding } from '../util/padding';\nimport { Background } from './background';\nimport { Legend } from './legend';\nimport { BBox } from '../scene/bbox';\nimport { find } from '../util/array';\nimport { SizeMonitor } from '../util/sizeMonitor';\nimport { Observable } from '../util/observable';\nimport { ChartAxisDirection } from './chartAxis';\nimport { createId } from '../util/id';\nimport { isPointLabelDatum, placeLabels } from '../util/labelPlacement';\nimport { debouncedAnimationFrame, debouncedCallback } from '../util/render';\nimport { CartesianSeries } from './series/cartesian/cartesianSeries';\nimport { BOOLEAN, Validate } from '../util/validation';\nimport { sleep } from '../util/async';\nimport { doOnce } from '../util/function';\nimport { Tooltip } from './tooltip/tooltip';\n/** Types of chart-update, in pipeline execution order. */\nexport var ChartUpdateType;\n(function (ChartUpdateType) {\n  ChartUpdateType[ChartUpdateType[\"FULL\"] = 0] = \"FULL\";\n  ChartUpdateType[ChartUpdateType[\"PROCESS_DATA\"] = 1] = \"PROCESS_DATA\";\n  ChartUpdateType[ChartUpdateType[\"PERFORM_LAYOUT\"] = 2] = \"PERFORM_LAYOUT\";\n  ChartUpdateType[ChartUpdateType[\"SERIES_UPDATE\"] = 3] = \"SERIES_UPDATE\";\n  ChartUpdateType[ChartUpdateType[\"SCENE_RENDER\"] = 4] = \"SCENE_RENDER\";\n  ChartUpdateType[ChartUpdateType[\"NONE\"] = 5] = \"NONE\";\n})(ChartUpdateType || (ChartUpdateType = {}));\nvar Chart = /** @class */function (_super) {\n  __extends(Chart, _super);\n  function Chart(document, overrideDevicePixelRatio) {\n    if (document === void 0) {\n      document = window.document;\n    }\n    var _this = _super.call(this) || this;\n    _this.id = createId(_this);\n    _this.options = {};\n    _this.userOptions = {};\n    _this.background = new Background();\n    _this.legend = new Legend();\n    _this.legendAutoPadding = new Padding();\n    _this._debug = false;\n    _this.extraDebugStats = {};\n    _this._container = undefined;\n    _this._data = [];\n    _this._autoSize = false;\n    _this.padding = new Padding(20);\n    _this._title = undefined;\n    _this._subtitle = undefined;\n    _this._destroyed = false;\n    _this._pendingFactoryUpdates = [];\n    _this._performUpdateNoRenderCount = 0;\n    _this._performUpdateType = ChartUpdateType.NONE;\n    _this.seriesToUpdate = new Set();\n    _this.performUpdateTrigger = debouncedCallback(function (_a) {\n      var count = _a.count;\n      return __awaiter(_this, void 0, void 0, function () {\n        var error_1;\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              _b.trys.push([0, 2,, 3]);\n              return [4 /*yield*/, this.performUpdate(count)];\n            case 1:\n              _b.sent();\n              return [3 /*break*/, 3];\n            case 2:\n              error_1 = _b.sent();\n              this._lastPerformUpdateError = error_1;\n              console.error(error_1);\n              return [3 /*break*/, 3];\n            case 3:\n              return [2 /*return*/];\n          }\n        });\n      });\n    });\n\n    _this._axes = [];\n    _this._series = [];\n    _this.legendBBox = new BBox(0, 0, 0, 0);\n    _this._onMouseDown = _this.onMouseDown.bind(_this);\n    _this._onMouseMove = _this.onMouseMove.bind(_this);\n    _this._onMouseUp = _this.onMouseUp.bind(_this);\n    _this._onMouseOut = _this.onMouseOut.bind(_this);\n    _this._onClick = _this.onClick.bind(_this);\n    _this.lastPointerMeta = undefined;\n    _this.pointerScheduler = debouncedAnimationFrame(function () {\n      _this.handlePointer(_this.lastPointerMeta);\n      _this.lastPointerMeta = undefined;\n    });\n    _this.pointerInsideLegend = false;\n    _this.pointerOverLegendDatum = false;\n    var root = new Group({\n      name: 'root'\n    });\n    var background = _this.background;\n    background.fill = 'white';\n    root.appendChild(background.node);\n    var element = _this.element = document.createElement('div');\n    element.classList.add('ag-chart-wrapper');\n    element.style.position = 'relative';\n    _this.scene = new Scene({\n      document: document,\n      overrideDevicePixelRatio: overrideDevicePixelRatio\n    });\n    _this.scene.debug.consoleLog = _this._debug;\n    _this.scene.root = root;\n    _this.scene.container = element;\n    _this.autoSize = true;\n    SizeMonitor.observe(_this.element, function (size) {\n      var width = size.width,\n        height = size.height;\n      if (!_this.autoSize) {\n        return;\n      }\n      if (width === 0 && height === 0) {\n        return;\n      }\n      if (width === _this.width && height === _this.height) {\n        return;\n      }\n      _this._lastAutoSize = [width, height];\n      _this.resize(width, height);\n    });\n    _this.tooltip = new Tooltip(function () {\n      return _this.scene.canvas.element;\n    }, document, function () {\n      return _this.container;\n    });\n    _this.setupDomListeners(_this.scene.canvas.element);\n    return _this;\n  }\n  Object.defineProperty(Chart.prototype, \"debug\", {\n    get: function () {\n      return this._debug;\n    },\n    set: function (value) {\n      this._debug = value;\n      this.scene.debug.consoleLog = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"container\", {\n    get: function () {\n      return this._container;\n    },\n    set: function (value) {\n      if (this._container !== value) {\n        var parentNode = this.element.parentNode;\n        if (parentNode != null) {\n          parentNode.removeChild(this.element);\n        }\n        if (value && !this.destroyed) {\n          value.appendChild(this.element);\n        }\n        this._container = value;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"data\", {\n    get: function () {\n      return this._data;\n    },\n    set: function (data) {\n      this._data = data;\n      this.series.forEach(function (series) {\n        return series.data = data;\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"width\", {\n    get: function () {\n      return this.scene.width;\n    },\n    set: function (value) {\n      this.autoSize = false;\n      if (this.width !== value) {\n        this.resize(value, this.height);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"height\", {\n    get: function () {\n      return this.scene.height;\n    },\n    set: function (value) {\n      this.autoSize = false;\n      if (this.height !== value) {\n        this.resize(this.width, value);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"autoSize\", {\n    get: function () {\n      return this._autoSize;\n    },\n    set: function (value) {\n      if (this._autoSize === value) {\n        return;\n      }\n      this._autoSize = value;\n      var style = this.element.style;\n      if (value) {\n        style.display = 'block';\n        style.width = '100%';\n        style.height = '100%';\n        if (!this._lastAutoSize) {\n          return;\n        }\n        this.resize(this._lastAutoSize[0], this._lastAutoSize[1]);\n      } else {\n        style.display = 'inline-block';\n        style.width = 'auto';\n        style.height = 'auto';\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Chart.prototype.download = function (fileName, fileFormat) {\n    this.scene.download(fileName, fileFormat);\n  };\n  Object.defineProperty(Chart.prototype, \"title\", {\n    get: function () {\n      return this._title;\n    },\n    set: function (caption) {\n      var _a, _b;\n      var root = this.scene.root;\n      if (this._title != null) {\n        (_a = root) === null || _a === void 0 ? void 0 : _a.removeChild(this._title.node);\n      }\n      this._title = caption;\n      if (this._title != null) {\n        (_b = root) === null || _b === void 0 ? void 0 : _b.appendChild(this._title.node);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"subtitle\", {\n    get: function () {\n      return this._subtitle;\n    },\n    set: function (caption) {\n      var _a, _b;\n      var root = this.scene.root;\n      if (this._subtitle != null) {\n        (_a = root) === null || _a === void 0 ? void 0 : _a.removeChild(this._subtitle.node);\n      }\n      this._subtitle = caption;\n      if (this._subtitle != null) {\n        (_b = root) === null || _b === void 0 ? void 0 : _b.appendChild(this._subtitle.node);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"destroyed\", {\n    get: function () {\n      return this._destroyed;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Chart.prototype.destroy = function () {\n    this._performUpdateType = ChartUpdateType.NONE;\n    this._pendingFactoryUpdates.splice(0);\n    this.tooltip.destroy();\n    SizeMonitor.unobserve(this.element);\n    this.container = undefined;\n    this.cleanupDomListeners(this.scene.canvas.element);\n    this.scene.destroy();\n    this.series.forEach(function (s) {\n      return s.destroy();\n    });\n    this.series = [];\n    this._destroyed = true;\n  };\n  Chart.prototype.log = function (opts) {\n    if (this.debug) {\n      console.log(opts);\n    }\n  };\n  Chart.prototype.togglePointer = function (visible) {\n    if (this.tooltip.enabled) {\n      this.tooltip.toggle(visible);\n    } else if (this.lastPick) {\n      this.changeHighlightDatum();\n    }\n  };\n  Chart.prototype.requestFactoryUpdate = function (cb) {\n    var callbacks = this._pendingFactoryUpdates;\n    var count = callbacks.length;\n    if (count === 0) {\n      callbacks.push(cb);\n      this._processCallbacks();\n    } else {\n      // Factory callback process already running, the callback will be invoked asynchronously.\n      // Clear the queue after the first callback to prevent unnecessary re-renderings.\n      callbacks.splice(1, count - 1, cb);\n    }\n  };\n  Chart.prototype._processCallbacks = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var callbacks, e_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            callbacks = this._pendingFactoryUpdates;\n            _a.label = 1;\n          case 1:\n            if (!(callbacks.length > 0)) return [3 /*break*/, 7];\n            if (!this.updatePending) return [3 /*break*/, 3];\n            return [4 /*yield*/, sleep(1)];\n          case 2:\n            _a.sent();\n            return [3 /*break*/, 1];\n          // Make sure to check queue has an item before continuing.\n          case 3:\n            _a.trys.push([3, 5,, 6]);\n            return [4 /*yield*/, callbacks[0]()];\n          case 4:\n            _a.sent();\n            return [3 /*break*/, 6];\n          case 5:\n            e_1 = _a.sent();\n            console.error(e_1);\n            return [3 /*break*/, 6];\n          case 6:\n            callbacks.shift();\n            return [3 /*break*/, 1];\n          case 7:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  Object.defineProperty(Chart.prototype, \"performUpdateType\", {\n    get: function () {\n      return this._performUpdateType;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"updatePending\", {\n    get: function () {\n      return this._performUpdateType !== ChartUpdateType.NONE || this.lastPointerMeta != null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Chart.prototype, \"lastPerformUpdateError\", {\n    get: function () {\n      return this._lastPerformUpdateError;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Chart.prototype.awaitUpdateCompletion = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.performUpdateTrigger.await()];\n          case 1:\n            _a.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  Chart.prototype.update = function (type, opts) {\n    var e_2, _a;\n    if (type === void 0) {\n      type = ChartUpdateType.FULL;\n    }\n    var _b = opts || {},\n      _c = _b.forceNodeDataRefresh,\n      forceNodeDataRefresh = _c === void 0 ? false : _c,\n      _d = _b.seriesToUpdate,\n      seriesToUpdate = _d === void 0 ? this.series : _d;\n    if (forceNodeDataRefresh) {\n      this.series.forEach(function (series) {\n        return series.markNodeDataDirty();\n      });\n    }\n    try {\n      for (var seriesToUpdate_1 = __values(seriesToUpdate), seriesToUpdate_1_1 = seriesToUpdate_1.next(); !seriesToUpdate_1_1.done; seriesToUpdate_1_1 = seriesToUpdate_1.next()) {\n        var series = seriesToUpdate_1_1.value;\n        this.seriesToUpdate.add(series);\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (seriesToUpdate_1_1 && !seriesToUpdate_1_1.done && (_a = seriesToUpdate_1.return)) _a.call(seriesToUpdate_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n    if (type < this._performUpdateType) {\n      this._performUpdateType = type;\n      this.performUpdateTrigger.schedule();\n    }\n  };\n  Chart.prototype.performUpdate = function (count) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, performUpdateType, extraDebugStats, splits, _b, count_1, seriesRect_1, seriesUpdates, end;\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            _a = this, performUpdateType = _a._performUpdateType, extraDebugStats = _a.extraDebugStats;\n            splits = [performance.now()];\n            _b = performUpdateType;\n            switch (_b) {\n              case ChartUpdateType.FULL:\n                return [3 /*break*/, 1];\n              case ChartUpdateType.PROCESS_DATA:\n                return [3 /*break*/, 1];\n              case ChartUpdateType.PERFORM_LAYOUT:\n                return [3 /*break*/, 3];\n              case ChartUpdateType.SERIES_UPDATE:\n                return [3 /*break*/, 5];\n              case ChartUpdateType.SCENE_RENDER:\n                return [3 /*break*/, 7];\n              case ChartUpdateType.NONE:\n                return [3 /*break*/, 9];\n            }\n            return [3 /*break*/, 10];\n          case 1:\n            return [4 /*yield*/, this.processData()];\n          case 2:\n            _c.sent();\n            splits.push(performance.now());\n            // Disable tooltip/highlight if the data fundamentally shifted.\n            this.disablePointer({\n              updateProcessing: false\n            });\n            _c.label = 3;\n          case 3:\n            if (this._autoSize && !this._lastAutoSize) {\n              count_1 = this._performUpdateNoRenderCount++;\n              if (count_1 < 5) {\n                // Reschedule if canvas size hasn't been set yet to avoid a race.\n                this._performUpdateType = ChartUpdateType.PERFORM_LAYOUT;\n                this.performUpdateTrigger.schedule();\n                return [3 /*break*/, 10];\n              }\n              // After several failed passes, continue and accept there maybe a redundant\n              // render. Sometimes this case happens when we already have the correct\n              // width/height, and we end up never rendering the chart in that scenario.\n            }\n\n            this._performUpdateNoRenderCount = 0;\n            return [4 /*yield*/, this.performLayout()];\n          case 4:\n            _c.sent();\n            splits.push(performance.now());\n            _c.label = 5;\n          case 5:\n            seriesRect_1 = this.seriesRect;\n            seriesUpdates = __spread(this.seriesToUpdate).map(function (series) {\n              return series.update({\n                seriesRect: seriesRect_1\n              });\n            });\n            this.seriesToUpdate.clear();\n            return [4 /*yield*/, Promise.all(seriesUpdates)];\n          case 6:\n            _c.sent();\n            splits.push(performance.now());\n            _c.label = 7;\n          case 7:\n            return [4 /*yield*/, this.scene.render({\n              debugSplitTimes: splits,\n              extraDebugStats: extraDebugStats\n            })];\n          case 8:\n            _c.sent();\n            this.extraDebugStats = {};\n            _c.label = 9;\n          case 9:\n            // Do nothing.\n            this._performUpdateType = ChartUpdateType.NONE;\n            _c.label = 10;\n          case 10:\n            end = performance.now();\n            this.log({\n              chart: this,\n              durationMs: Math.round((end - splits[0]) * 100) / 100,\n              count: count,\n              performUpdateType: ChartUpdateType[performUpdateType]\n            });\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  Object.defineProperty(Chart.prototype, \"axes\", {\n    get: function () {\n      return this._axes;\n    },\n    set: function (values) {\n      var _this = this;\n      this._axes.forEach(function (axis) {\n        return _this.detachAxis(axis);\n      });\n      // make linked axes go after the regular ones (simulates stable sort by `linkedTo` property)\n      this._axes = values.filter(function (a) {\n        return !a.linkedTo;\n      }).concat(values.filter(function (a) {\n        return a.linkedTo;\n      }));\n      this._axes.forEach(function (axis) {\n        return _this.attachAxis(axis);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Chart.prototype.attachAxis = function (axis) {\n    this.scene.root.insertBefore(axis.gridlineGroup, this.seriesRoot);\n    this.scene.root.insertBefore(axis.axisGroup, this.seriesRoot);\n    this.scene.root.insertBefore(axis.crossLineGroup, this.seriesRoot);\n  };\n  Chart.prototype.detachAxis = function (axis) {\n    this.scene.root.removeChild(axis.axisGroup);\n    this.scene.root.removeChild(axis.gridlineGroup);\n    this.scene.root.removeChild(axis.crossLineGroup);\n  };\n  Object.defineProperty(Chart.prototype, \"series\", {\n    get: function () {\n      return this._series;\n    },\n    set: function (values) {\n      var _this = this;\n      this.removeAllSeries();\n      values.forEach(function (series) {\n        return _this.addSeries(series);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Chart.prototype.addSeries = function (series, before) {\n    var _a = this,\n      allSeries = _a.series,\n      seriesRoot = _a.seriesRoot;\n    var canAdd = allSeries.indexOf(series) < 0;\n    if (canAdd) {\n      var beforeIndex = before ? allSeries.indexOf(before) : -1;\n      if (beforeIndex >= 0) {\n        allSeries.splice(beforeIndex, 0, series);\n        seriesRoot.insertBefore(series.group, before.group);\n      } else {\n        allSeries.push(series);\n        seriesRoot.append(series.group);\n      }\n      this.initSeries(series);\n      return true;\n    }\n    return false;\n  };\n  Chart.prototype.initSeries = function (series) {\n    series.chart = this;\n    if (!series.data) {\n      series.data = this.data;\n    }\n    series.addEventListener('nodeClick', this.onSeriesNodeClick, this);\n  };\n  Chart.prototype.freeSeries = function (series) {\n    series.chart = undefined;\n    series.removeEventListener('nodeClick', this.onSeriesNodeClick, this);\n  };\n  Chart.prototype.addSeriesAfter = function (series, after) {\n    var _a = this,\n      allSeries = _a.series,\n      seriesRoot = _a.seriesRoot;\n    var canAdd = allSeries.indexOf(series) < 0;\n    if (canAdd) {\n      var afterIndex = after ? this.series.indexOf(after) : -1;\n      if (afterIndex >= 0) {\n        if (afterIndex + 1 < allSeries.length) {\n          seriesRoot.insertBefore(series.group, allSeries[afterIndex + 1].group);\n        } else {\n          seriesRoot.append(series.group);\n        }\n        this.initSeries(series);\n        allSeries.splice(afterIndex + 1, 0, series);\n      } else {\n        if (allSeries.length > 0) {\n          seriesRoot.insertBefore(series.group, allSeries[0].group);\n        } else {\n          seriesRoot.append(series.group);\n        }\n        this.initSeries(series);\n        allSeries.unshift(series);\n      }\n    }\n    return false;\n  };\n  Chart.prototype.removeSeries = function (series) {\n    var index = this.series.indexOf(series);\n    if (index >= 0) {\n      this.series.splice(index, 1);\n      this.freeSeries(series);\n      this.seriesRoot.removeChild(series.group);\n      return true;\n    }\n    return false;\n  };\n  Chart.prototype.removeAllSeries = function () {\n    var _this = this;\n    this.series.forEach(function (series) {\n      _this.freeSeries(series);\n      _this.seriesRoot.removeChild(series.group);\n    });\n    this._series = []; // using `_series` instead of `series` to prevent infinite recursion\n  };\n\n  Chart.prototype.assignSeriesToAxes = function () {\n    var _this = this;\n    this.axes.forEach(function (axis) {\n      axis.boundSeries = _this.series.filter(function (s) {\n        var seriesAxis = axis.direction === ChartAxisDirection.X ? s.xAxis : s.yAxis;\n        return seriesAxis === axis;\n      });\n    });\n  };\n  Chart.prototype.assignAxesToSeries = function (force) {\n    var _this = this;\n    if (force === void 0) {\n      force = false;\n    }\n    // This method has to run before `assignSeriesToAxes`.\n    var directionToAxesMap = {};\n    this.axes.forEach(function (axis) {\n      var direction = axis.direction;\n      var directionAxes = directionToAxesMap[direction] || (directionToAxesMap[direction] = []);\n      directionAxes.push(axis);\n    });\n    this.series.forEach(function (series) {\n      series.directions.forEach(function (direction) {\n        var currentAxis = direction === ChartAxisDirection.X ? series.xAxis : series.yAxis;\n        if (currentAxis && !force) {\n          return;\n        }\n        var directionAxes = directionToAxesMap[direction];\n        if (!directionAxes) {\n          console.warn(\"AG Charts - no available axis for direction [\" + direction + \"]; check series and axes configuration.\");\n          return;\n        }\n        var seriesKeys = series.getKeys(direction);\n        var newAxis = _this.findMatchingAxis(directionAxes, series.getKeys(direction));\n        if (!newAxis) {\n          console.warn(\"AG Charts - no matching axis for direction [\" + direction + \"] and keys [\" + seriesKeys + \"]; check series and axes configuration.\");\n          return;\n        }\n        if (direction === ChartAxisDirection.X) {\n          series.xAxis = newAxis;\n        } else {\n          series.yAxis = newAxis;\n        }\n      });\n    });\n  };\n  Chart.prototype.findMatchingAxis = function (directionAxes, directionKeys) {\n    var e_3, _a, e_4, _b;\n    try {\n      for (var directionAxes_1 = __values(directionAxes), directionAxes_1_1 = directionAxes_1.next(); !directionAxes_1_1.done; directionAxes_1_1 = directionAxes_1.next()) {\n        var axis = directionAxes_1_1.value;\n        var axisKeys = axis.keys;\n        if (!axisKeys.length) {\n          return axis;\n        }\n        if (!directionKeys) {\n          continue;\n        }\n        try {\n          for (var directionKeys_1 = (e_4 = void 0, __values(directionKeys)), directionKeys_1_1 = directionKeys_1.next(); !directionKeys_1_1.done; directionKeys_1_1 = directionKeys_1.next()) {\n            var directionKey = directionKeys_1_1.value;\n            if (axisKeys.indexOf(directionKey) >= 0) {\n              return axis;\n            }\n          }\n        } catch (e_4_1) {\n          e_4 = {\n            error: e_4_1\n          };\n        } finally {\n          try {\n            if (directionKeys_1_1 && !directionKeys_1_1.done && (_b = directionKeys_1.return)) _b.call(directionKeys_1);\n          } finally {\n            if (e_4) throw e_4.error;\n          }\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (directionAxes_1_1 && !directionAxes_1_1.done && (_a = directionAxes_1.return)) _a.call(directionAxes_1);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n  };\n  Chart.prototype.resize = function (width, height) {\n    if (this.scene.resize(width, height)) {\n      this.background.width = this.width;\n      this.background.height = this.height;\n      this.update(ChartUpdateType.PERFORM_LAYOUT, {\n        forceNodeDataRefresh: true\n      });\n    }\n  };\n  Chart.prototype.processData = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (this.axes.length > 0 || this.series.some(function (s) {\n              return s instanceof CartesianSeries;\n            })) {\n              this.assignAxesToSeries(true);\n              this.assignSeriesToAxes();\n            }\n            return [4 /*yield*/, Promise.all(this.series.map(function (s) {\n              return s.processData();\n            }))];\n          case 1:\n            _a.sent();\n            return [4 /*yield*/, this.updateLegend()];\n          case 2:\n            _a.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  Chart.prototype.placeLabels = function () {\n    var e_5, _a;\n    var visibleSeries = [];\n    var data = [];\n    try {\n      for (var _b = __values(this.series), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var series = _c.value;\n        if (!series.visible) {\n          continue;\n        }\n        var labelData = series.getLabelData();\n        if (!(labelData && isPointLabelDatum(labelData[0]))) {\n          continue;\n        }\n        data.push(labelData);\n        visibleSeries.push(series);\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n    var seriesRect = this.seriesRect;\n    var labels = seriesRect && data.length > 0 ? placeLabels(data, {\n      x: 0,\n      y: 0,\n      width: seriesRect.width,\n      height: seriesRect.height\n    }) : [];\n    return new Map(labels.map(function (l, i) {\n      return [visibleSeries[i], l];\n    }));\n  };\n  Chart.prototype.updateLegend = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var legendData, formatter;\n      return __generator(this, function (_a) {\n        legendData = [];\n        this.series.filter(function (s) {\n          return s.showInLegend;\n        }).forEach(function (series) {\n          legendData.push.apply(legendData, __spread(series.getLegendData()));\n        });\n        formatter = this.legend.item.label.formatter;\n        if (formatter) {\n          legendData.forEach(function (datum) {\n            return datum.label.text = formatter({\n              get id() {\n                doOnce(function () {\n                  return console.warn(\"AG Charts - LegendLabelFormatterParams.id is deprecated, use seriesId instead\", datum);\n                }, \"LegendLabelFormatterParams.id deprecated\");\n                return datum.seriesId;\n              },\n              itemId: datum.itemId,\n              value: datum.label.text,\n              seriesId: datum.seriesId\n            });\n          });\n        }\n        this.legend.data = legendData;\n        return [2 /*return*/];\n      });\n    });\n  };\n\n  Chart.prototype.positionCaptions = function () {\n    var _a = this,\n      title = _a._title,\n      subtitle = _a._subtitle;\n    var spacing = 10;\n    var paddingTop = spacing;\n    if (!title) {\n      return {};\n    }\n    title.node.visible = title.enabled;\n    if (title.enabled) {\n      title.node.x = this.width / 2;\n      title.node.y = paddingTop;\n      var titleBBox = title.node.computeBBox(); // make sure to set node's x/y, then computeBBox\n      if (titleBBox) {\n        paddingTop = titleBBox.y + titleBBox.height;\n      }\n    }\n    if (!subtitle) {\n      return {};\n    }\n    subtitle.node.visible = title.enabled && subtitle.enabled;\n    if (title.enabled && subtitle.enabled) {\n      subtitle.node.x = this.width / 2;\n      subtitle.node.y = paddingTop + spacing;\n      var subtitleBBox = subtitle.node.computeBBox();\n      if (subtitleBBox) {\n        paddingTop = subtitleBBox.y + subtitleBBox.height;\n      }\n    }\n    return {\n      captionAutoPadding: Math.floor(paddingTop)\n    };\n  };\n  Chart.prototype.positionLegend = function (captionAutoPadding) {\n    var _a = this,\n      legend = _a.legend,\n      legendAutoPadding = _a.legendAutoPadding;\n    legendAutoPadding.clear();\n    if (!legend.enabled || !legend.data.length) {\n      return;\n    }\n    var width = this.width;\n    var height = this.height - captionAutoPadding;\n    var legendGroup = legend.group;\n    var legendSpacing = legend.spacing;\n    var translationX = 0;\n    var translationY = 0;\n    var legendBBox;\n    switch (legend.position) {\n      case 'bottom':\n        legend.performLayout(width - legendSpacing * 2, 0);\n        legendBBox = legendGroup.computeBBox();\n        legendGroup.visible = legendBBox.height < Math.floor(height * 0.5); // Remove legend if it takes up more than 50% of the chart height.\n        if (legendGroup.visible) {\n          translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n          translationY = captionAutoPadding + height - legendBBox.height - legendBBox.y - legendSpacing;\n          legendAutoPadding.bottom = legendBBox.height;\n        } else {\n          legendAutoPadding.bottom = 0;\n        }\n        break;\n      case 'top':\n        legend.performLayout(width - legendSpacing * 2, 0);\n        legendBBox = legendGroup.computeBBox();\n        legendGroup.visible = legendBBox.height < Math.floor(height * 0.5);\n        if (legendGroup.visible) {\n          translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n          translationY = captionAutoPadding + legendSpacing - legendBBox.y;\n          legendAutoPadding.top = legendBBox.height;\n        } else {\n          legendAutoPadding.top = 0;\n        }\n        break;\n      case 'left':\n        legend.performLayout(width, height - legendSpacing * 2);\n        legendBBox = legendGroup.computeBBox();\n        legendGroup.visible = legendBBox.width < Math.floor(width * 0.5); // Remove legend if it takes up more than 50% of the chart width.\n        if (legendGroup.visible) {\n          translationX = legendSpacing - legendBBox.x;\n          translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n          legendAutoPadding.left = legendBBox.width;\n        } else {\n          legendAutoPadding.left = 0;\n        }\n        break;\n      default:\n        // case 'right':\n        legend.performLayout(width, height - legendSpacing * 2);\n        legendBBox = legendGroup.computeBBox();\n        legendGroup.visible = legendBBox.width < Math.floor(width * 0.5);\n        if (legendGroup.visible) {\n          translationX = width - legendBBox.width - legendBBox.x - legendSpacing;\n          translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n          legendAutoPadding.right = legendBBox.width;\n        } else {\n          legendAutoPadding.right = 0;\n        }\n        break;\n    }\n    if (legendGroup.visible) {\n      // Round off for pixel grid alignment to work properly.\n      legendGroup.translationX = Math.floor(translationX + legendGroup.translationX);\n      legendGroup.translationY = Math.floor(translationY + legendGroup.translationY);\n      this.legendBBox = legendGroup.computeBBox();\n    }\n  };\n  Chart.prototype.setupDomListeners = function (chartElement) {\n    chartElement.addEventListener('mousedown', this._onMouseDown);\n    chartElement.addEventListener('mousemove', this._onMouseMove);\n    chartElement.addEventListener('mouseup', this._onMouseUp);\n    chartElement.addEventListener('mouseout', this._onMouseOut);\n    chartElement.addEventListener('click', this._onClick);\n  };\n  Chart.prototype.cleanupDomListeners = function (chartElement) {\n    chartElement.removeEventListener('mousedown', this._onMouseDown);\n    chartElement.removeEventListener('mousemove', this._onMouseMove);\n    chartElement.removeEventListener('mouseup', this._onMouseUp);\n    chartElement.removeEventListener('mouseout', this._onMouseOut);\n    chartElement.removeEventListener('click', this._onClick);\n  };\n  Chart.prototype.getSeriesRect = function () {\n    return this.seriesRect;\n  };\n  // x/y are local canvas coordinates in CSS pixels, not actual pixels\n  Chart.prototype.pickSeriesNode = function (point) {\n    var e_6, _a;\n    var _b, _c;\n    var tracking = this.tooltip.tracking;\n    var start = performance.now();\n    // Disable 'nearest match' options if tooltip.tracking is enabled.\n    var pickModes = tracking ? undefined : [SeriesNodePickMode.EXACT_SHAPE_MATCH];\n    // Iterate through series in reverse, as later declared series appears on top of earlier\n    // declared series.\n    var reverseSeries = __spread(this.series).reverse();\n    var result = undefined;\n    try {\n      for (var reverseSeries_1 = __values(reverseSeries), reverseSeries_1_1 = reverseSeries_1.next(); !reverseSeries_1_1.done; reverseSeries_1_1 = reverseSeries_1.next()) {\n        var series = reverseSeries_1_1.value;\n        if (!series.visible || !series.group.visible) {\n          continue;\n        }\n        var _d = (_b = series.pickNode(point, pickModes), _b !== null && _b !== void 0 ? _b : {}),\n          match = _d.match,\n          distance = _d.distance;\n        if (!match || distance == null) {\n          continue;\n        }\n        if (!result || result.distance > distance) {\n          result = {\n            series: series,\n            distance: distance,\n            datum: match\n          };\n        }\n        if (distance === 0) {\n          break;\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (reverseSeries_1_1 && !reverseSeries_1_1.done && (_a = reverseSeries_1.return)) _a.call(reverseSeries_1);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n    this.extraDebugStats['pickSeriesNode'] = Math.round((_c = this.extraDebugStats['pickSeriesNode'], _c !== null && _c !== void 0 ? _c : 0) + (performance.now() - start));\n    return result;\n  };\n  Chart.prototype.onMouseMove = function (event) {\n    this.handleLegendMouseMove(event);\n    if (this.tooltip.enabled) {\n      if (this.tooltip.delay > 0) {\n        this.togglePointer(false);\n      }\n    }\n    this.lastPointerMeta = {\n      pageX: event.pageX,\n      pageY: event.pageY,\n      offsetX: event.offsetX,\n      offsetY: event.offsetY,\n      event: event\n    };\n    this.pointerScheduler.schedule();\n    this.extraDebugStats['mouseX'] = event.offsetX;\n    this.extraDebugStats['mouseY'] = event.offsetY;\n    this.update(ChartUpdateType.SCENE_RENDER);\n  };\n  Chart.prototype.disablePointer = function (_a) {\n    var _b = (_a === void 0 ? {} : _a).updateProcessing,\n      updateProcessing = _b === void 0 ? true : _b;\n    this.changeHighlightDatum(undefined, {\n      updateProcessing: updateProcessing\n    });\n    this.togglePointer(false);\n  };\n  Chart.prototype.handlePointer = function (meta) {\n    var _this = this;\n    var lastPick = this.lastPick;\n    var offsetX = meta.offsetX,\n      offsetY = meta.offsetY;\n    var disablePointer = function () {\n      if (lastPick) {\n        // Cursor moved from a non-marker node to empty space.\n        _this.disablePointer();\n      }\n    };\n    if (!(this.seriesRect && this.seriesRect.containsPoint(offsetX, offsetY))) {\n      disablePointer();\n      return;\n    }\n    var pick = this.pickSeriesNode({\n      x: offsetX,\n      y: offsetY\n    });\n    if (!pick) {\n      disablePointer();\n      return;\n    }\n    if (!lastPick || lastPick.datum !== pick.datum) {\n      this.onSeriesDatumPick(meta, pick.datum);\n      return;\n    }\n    lastPick.event = meta.event;\n    if (this.tooltip.enabled && pick.series.tooltip.enabled) {\n      this.tooltip.show(this.mergePointerDatum(meta, pick.datum));\n    }\n  };\n  Chart.prototype.onMouseDown = function (_event) {\n    // Override point for subclasses.\n  };\n  Chart.prototype.onMouseUp = function (_event) {\n    // Override point for subclasses.\n  };\n  Chart.prototype.onMouseOut = function (_event) {\n    this.togglePointer(false);\n  };\n  Chart.prototype.onClick = function (event) {\n    if (this.checkSeriesNodeClick()) {\n      this.update(ChartUpdateType.SERIES_UPDATE);\n      return;\n    }\n    if (this.checkLegendClick(event)) {\n      this.update(ChartUpdateType.PROCESS_DATA, {\n        forceNodeDataRefresh: true\n      });\n      return;\n    }\n    this.fireEvent({\n      type: 'click',\n      event: event\n    });\n  };\n  Chart.prototype.checkSeriesNodeClick = function () {\n    var lastPick = this.lastPick;\n    if (lastPick && lastPick.event) {\n      var event_1 = lastPick.event,\n        datum = lastPick.datum;\n      datum.series.fireNodeClickEvent(event_1, datum);\n      return true;\n    }\n    return false;\n  };\n  Chart.prototype.onSeriesNodeClick = function (event) {\n    var seriesNodeClickEvent = __assign(__assign({}, event), {\n      type: 'seriesNodeClick'\n    });\n    Object.defineProperty(seriesNodeClickEvent, 'series', {\n      enumerable: false,\n      // Should display the deprecation warning\n      get: function () {\n        return event.series;\n      }\n    });\n    this.fireEvent(seriesNodeClickEvent);\n  };\n  Chart.prototype.checkLegendClick = function (event) {\n    var _a;\n    var _b = this,\n      legend = _b.legend,\n      legendItemClick = _b.legend.listeners.legendItemClick;\n    var datum = legend.getDatumForPoint(event.offsetX, event.offsetY);\n    if (!datum) {\n      return false;\n    }\n    var id = datum.id,\n      itemId = datum.itemId,\n      enabled = datum.enabled;\n    var series = find(this.series, function (s) {\n      return s.id === id;\n    });\n    if (!series) {\n      return false;\n    }\n    series.toggleSeriesItem(itemId, !enabled);\n    if (enabled) {\n      this.togglePointer(false);\n    }\n    if (enabled && ((_a = this.highlightedDatum) === null || _a === void 0 ? void 0 : _a.series) === series) {\n      this.highlightedDatum = undefined;\n    }\n    if (!enabled) {\n      this.highlightedDatum = {\n        series: series,\n        itemId: itemId,\n        datum: undefined\n      };\n    }\n    legendItemClick({\n      enabled: !enabled,\n      itemId: itemId,\n      seriesId: series.id\n    });\n    return true;\n  };\n  Chart.prototype.handleLegendMouseMove = function (event) {\n    if (!this.legend.enabled) {\n      return;\n    }\n    var offsetX = event.offsetX,\n      offsetY = event.offsetY;\n    var datum = this.legend.getDatumForPoint(offsetX, offsetY);\n    var pointerInsideLegend = this.legendBBox.containsPoint(offsetX, offsetY);\n    var pointerOverLegendDatum = pointerInsideLegend && datum !== undefined;\n    if (!pointerInsideLegend && this.pointerInsideLegend) {\n      this.pointerInsideLegend = false;\n      this.element.style.cursor = 'default';\n      // Dehighlight if the pointer was inside the legend and is now leaving it.\n      this.changeHighlightDatum();\n      return;\n    }\n    if (pointerOverLegendDatum && !this.pointerOverLegendDatum) {\n      this.element.style.cursor = 'pointer';\n      if (datum && this.legend.truncatedItems.has(datum.itemId || datum.id)) {\n        this.element.title = datum.label.text;\n      } else {\n        this.element.title = '';\n      }\n    }\n    if (!pointerOverLegendDatum && this.pointerOverLegendDatum) {\n      this.element.style.cursor = 'default';\n    }\n    this.pointerInsideLegend = pointerInsideLegend;\n    this.pointerOverLegendDatum = pointerOverLegendDatum;\n    var oldHighlightedDatum = this.highlightedDatum;\n    if (datum) {\n      var id_1 = datum.id,\n        itemId = datum.itemId,\n        enabled = datum.enabled;\n      if (enabled) {\n        var series = find(this.series, function (series) {\n          return series.id === id_1;\n        });\n        if (series) {\n          this.highlightedDatum = {\n            series: series,\n            itemId: itemId,\n            datum: undefined\n          };\n        }\n      } else {\n        this.highlightedDatum = undefined;\n      }\n    }\n    // Careful to only schedule updates when necessary.\n    if (this.highlightedDatum && !oldHighlightedDatum || !this.highlightedDatum && oldHighlightedDatum || this.highlightedDatum && oldHighlightedDatum && (this.highlightedDatum.series !== oldHighlightedDatum.series || this.highlightedDatum.itemId !== oldHighlightedDatum.itemId)) {\n      this.update(ChartUpdateType.SERIES_UPDATE);\n    }\n  };\n  Chart.prototype.onSeriesDatumPick = function (meta, datum) {\n    var lastPick = this.lastPick;\n    if (lastPick) {\n      if (lastPick.datum === datum) {\n        return;\n      }\n    }\n    this.changeHighlightDatum({\n      datum: datum,\n      event: meta.event\n    });\n    if (datum) {\n      meta = this.mergePointerDatum(meta, datum);\n    }\n    var tooltipEnabled = this.tooltip.enabled && datum.series.tooltip.enabled;\n    var html = tooltipEnabled && datum.series.getTooltipHtml(datum);\n    if (html) {\n      this.tooltip.show(meta, html);\n    }\n  };\n  Chart.prototype.mergePointerDatum = function (meta, datum) {\n    if (datum.point) {\n      var _a = datum.point,\n        x = _a.x,\n        y = _a.y;\n      var canvas = this.scene.canvas;\n      var point = datum.series.group.inverseTransformPoint(x, y);\n      var canvasRect = canvas.element.getBoundingClientRect();\n      return __assign(__assign({}, meta), {\n        pageX: Math.round(canvasRect.left + window.scrollX + point.x),\n        pageY: Math.round(canvasRect.top + window.scrollY + point.y),\n        offsetX: Math.round(canvasRect.left + point.y),\n        offsetY: Math.round(canvasRect.top + point.y)\n      });\n    }\n    return meta;\n  };\n  Chart.prototype.changeHighlightDatum = function (newPick, opts) {\n    var _a = (opts !== null && opts !== void 0 ? opts : {}).updateProcessing,\n      updateProcessing = _a === void 0 ? true : _a;\n    var seriesToUpdate = new Set();\n    var _b = newPick || {},\n      _c = _b.datum,\n      _d = (_c === void 0 ? {} : _c).series,\n      newSeries = _d === void 0 ? undefined : _d,\n      _e = _b.datum,\n      datum = _e === void 0 ? undefined : _e;\n    var _f = this.lastPick,\n      _g = (_f === void 0 ? {} : _f).datum,\n      _h = (_g === void 0 ? {} : _g).series,\n      lastSeries = _h === void 0 ? undefined : _h;\n    if (lastSeries) {\n      seriesToUpdate.add(lastSeries);\n    }\n    if (newSeries) {\n      seriesToUpdate.add(newSeries);\n      this.element.style.cursor = newSeries.cursor;\n    }\n    this.lastPick = newPick;\n    this.highlightedDatum = datum;\n    if (!updateProcessing) {\n      return;\n    }\n    var updateAll = newSeries == null || lastSeries == null;\n    if (updateAll) {\n      this.update(ChartUpdateType.SERIES_UPDATE);\n    } else {\n      this.update(ChartUpdateType.SERIES_UPDATE, {\n        seriesToUpdate: seriesToUpdate\n      });\n    }\n  };\n  Chart.prototype.waitForUpdate = function (timeoutMs) {\n    if (timeoutMs === void 0) {\n      timeoutMs = 5000;\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var start;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            start = performance.now();\n            _a.label = 1;\n          case 1:\n            if (!(this._pendingFactoryUpdates.length > 0 || this.updatePending)) return [3 /*break*/, 3];\n            if (performance.now() - start > timeoutMs) {\n              throw new Error('waitForUpdate() timeout reached.');\n            }\n            return [4 /*yield*/, sleep(5)];\n          case 2:\n            _a.sent();\n            return [3 /*break*/, 1];\n          case 3:\n            return [4 /*yield*/, this.awaitUpdateCompletion()];\n          case 4:\n            _a.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  __decorate([Validate(BOOLEAN)], Chart.prototype, \"_autoSize\", void 0);\n  return Chart;\n}(Observable);\nexport { Chart };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","__read","ar","error","__spread","concat","Scene","Group","SeriesNodePickMode","Padding","Background","Legend","BBox","find","SizeMonitor","Observable","ChartAxisDirection","createId","isPointLabelDatum","placeLabels","debouncedAnimationFrame","debouncedCallback","CartesianSeries","BOOLEAN","Validate","sleep","doOnce","Tooltip","ChartUpdateType","Chart","_super","document","overrideDevicePixelRatio","window","_this","id","options","userOptions","background","legend","legendAutoPadding","_debug","extraDebugStats","_container","undefined","_data","_autoSize","padding","_title","_subtitle","_destroyed","_pendingFactoryUpdates","_performUpdateNoRenderCount","_performUpdateType","NONE","seriesToUpdate","Set","performUpdateTrigger","_a","count","error_1","_b","performUpdate","_lastPerformUpdateError","console","_axes","_series","legendBBox","_onMouseDown","onMouseDown","bind","_onMouseMove","onMouseMove","_onMouseUp","onMouseUp","_onMouseOut","onMouseOut","_onClick","onClick","lastPointerMeta","pointerScheduler","handlePointer","pointerInsideLegend","pointerOverLegendDatum","root","name","fill","appendChild","node","element","createElement","classList","add","style","position","scene","debug","consoleLog","container","autoSize","observe","size","width","height","_lastAutoSize","resize","tooltip","canvas","setupDomListeners","get","set","enumerable","configurable","parentNode","removeChild","destroyed","data","series","forEach","display","download","fileName","fileFormat","caption","destroy","splice","unobserve","cleanupDomListeners","log","opts","togglePointer","visible","enabled","toggle","lastPick","changeHighlightDatum","requestFactoryUpdate","cb","callbacks","_processCallbacks","e_1","updatePending","shift","awaitUpdateCompletion","await","update","type","e_2","FULL","_c","forceNodeDataRefresh","_d","markNodeDataDirty","seriesToUpdate_1","seriesToUpdate_1_1","e_2_1","return","schedule","performUpdateType","splits","count_1","seriesRect_1","seriesUpdates","end","performance","now","PROCESS_DATA","PERFORM_LAYOUT","SERIES_UPDATE","SCENE_RENDER","processData","disablePointer","updateProcessing","performLayout","seriesRect","map","clear","all","render","debugSplitTimes","chart","durationMs","Math","round","values","axis","detachAxis","filter","a","linkedTo","attachAxis","insertBefore","gridlineGroup","seriesRoot","axisGroup","crossLineGroup","removeAllSeries","addSeries","before","allSeries","canAdd","indexOf","beforeIndex","group","append","initSeries","addEventListener","onSeriesNodeClick","freeSeries","removeEventListener","addSeriesAfter","after","afterIndex","unshift","removeSeries","index","assignSeriesToAxes","axes","boundSeries","seriesAxis","direction","X","xAxis","yAxis","assignAxesToSeries","force","directionToAxesMap","directionAxes","directions","currentAxis","warn","seriesKeys","getKeys","newAxis","findMatchingAxis","directionKeys","e_3","e_4","directionAxes_1","directionAxes_1_1","axisKeys","keys","directionKeys_1","directionKeys_1_1","directionKey","e_4_1","e_3_1","some","updateLegend","e_5","visibleSeries","labelData","getLabelData","e_5_1","labels","x","Map","l","legendData","formatter","showInLegend","getLegendData","item","datum","text","seriesId","itemId","positionCaptions","title","subtitle","spacing","paddingTop","titleBBox","computeBBox","subtitleBBox","captionAutoPadding","floor","positionLegend","legendGroup","legendSpacing","translationX","translationY","bottom","top","left","right","chartElement","getSeriesRect","pickSeriesNode","point","e_6","tracking","start","pickModes","EXACT_SHAPE_MATCH","reverseSeries","reverse","reverseSeries_1","reverseSeries_1_1","pickNode","match","distance","e_6_1","event","handleLegendMouseMove","delay","pageX","pageY","offsetX","offsetY","meta","containsPoint","pick","onSeriesDatumPick","show","mergePointerDatum","_event","checkSeriesNodeClick","checkLegendClick","fireEvent","event_1","fireNodeClickEvent","seriesNodeClickEvent","legendItemClick","listeners","getDatumForPoint","toggleSeriesItem","highlightedDatum","cursor","truncatedItems","has","oldHighlightedDatum","id_1","tooltipEnabled","html","getTooltipHtml","inverseTransformPoint","canvasRect","getBoundingClientRect","scrollX","scrollY","newPick","newSeries","_e","_f","_g","_h","lastSeries","updateAll","waitForUpdate","timeoutMs","Error"],"sources":["C:/Users/guzny/OneDrive/Рабочий стол/frontend/node_modules/ag-charts-community/dist/esm/es5/chart/chart.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport { Scene } from '../scene/scene';\nimport { Group } from '../scene/group';\nimport { SeriesNodePickMode } from './series/series';\nimport { Padding } from '../util/padding';\nimport { Background } from './background';\nimport { Legend } from './legend';\nimport { BBox } from '../scene/bbox';\nimport { find } from '../util/array';\nimport { SizeMonitor } from '../util/sizeMonitor';\nimport { Observable } from '../util/observable';\nimport { ChartAxisDirection } from './chartAxis';\nimport { createId } from '../util/id';\nimport { isPointLabelDatum, placeLabels } from '../util/labelPlacement';\nimport { debouncedAnimationFrame, debouncedCallback } from '../util/render';\nimport { CartesianSeries } from './series/cartesian/cartesianSeries';\nimport { BOOLEAN, Validate } from '../util/validation';\nimport { sleep } from '../util/async';\nimport { doOnce } from '../util/function';\nimport { Tooltip } from './tooltip/tooltip';\n/** Types of chart-update, in pipeline execution order. */\nexport var ChartUpdateType;\n(function (ChartUpdateType) {\n    ChartUpdateType[ChartUpdateType[\"FULL\"] = 0] = \"FULL\";\n    ChartUpdateType[ChartUpdateType[\"PROCESS_DATA\"] = 1] = \"PROCESS_DATA\";\n    ChartUpdateType[ChartUpdateType[\"PERFORM_LAYOUT\"] = 2] = \"PERFORM_LAYOUT\";\n    ChartUpdateType[ChartUpdateType[\"SERIES_UPDATE\"] = 3] = \"SERIES_UPDATE\";\n    ChartUpdateType[ChartUpdateType[\"SCENE_RENDER\"] = 4] = \"SCENE_RENDER\";\n    ChartUpdateType[ChartUpdateType[\"NONE\"] = 5] = \"NONE\";\n})(ChartUpdateType || (ChartUpdateType = {}));\nvar Chart = /** @class */ (function (_super) {\n    __extends(Chart, _super);\n    function Chart(document, overrideDevicePixelRatio) {\n        if (document === void 0) { document = window.document; }\n        var _this = _super.call(this) || this;\n        _this.id = createId(_this);\n        _this.options = {};\n        _this.userOptions = {};\n        _this.background = new Background();\n        _this.legend = new Legend();\n        _this.legendAutoPadding = new Padding();\n        _this._debug = false;\n        _this.extraDebugStats = {};\n        _this._container = undefined;\n        _this._data = [];\n        _this._autoSize = false;\n        _this.padding = new Padding(20);\n        _this._title = undefined;\n        _this._subtitle = undefined;\n        _this._destroyed = false;\n        _this._pendingFactoryUpdates = [];\n        _this._performUpdateNoRenderCount = 0;\n        _this._performUpdateType = ChartUpdateType.NONE;\n        _this.seriesToUpdate = new Set();\n        _this.performUpdateTrigger = debouncedCallback(function (_a) {\n            var count = _a.count;\n            return __awaiter(_this, void 0, void 0, function () {\n                var error_1;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            _b.trys.push([0, 2, , 3]);\n                            return [4 /*yield*/, this.performUpdate(count)];\n                        case 1:\n                            _b.sent();\n                            return [3 /*break*/, 3];\n                        case 2:\n                            error_1 = _b.sent();\n                            this._lastPerformUpdateError = error_1;\n                            console.error(error_1);\n                            return [3 /*break*/, 3];\n                        case 3: return [2 /*return*/];\n                    }\n                });\n            });\n        });\n        _this._axes = [];\n        _this._series = [];\n        _this.legendBBox = new BBox(0, 0, 0, 0);\n        _this._onMouseDown = _this.onMouseDown.bind(_this);\n        _this._onMouseMove = _this.onMouseMove.bind(_this);\n        _this._onMouseUp = _this.onMouseUp.bind(_this);\n        _this._onMouseOut = _this.onMouseOut.bind(_this);\n        _this._onClick = _this.onClick.bind(_this);\n        _this.lastPointerMeta = undefined;\n        _this.pointerScheduler = debouncedAnimationFrame(function () {\n            _this.handlePointer(_this.lastPointerMeta);\n            _this.lastPointerMeta = undefined;\n        });\n        _this.pointerInsideLegend = false;\n        _this.pointerOverLegendDatum = false;\n        var root = new Group({ name: 'root' });\n        var background = _this.background;\n        background.fill = 'white';\n        root.appendChild(background.node);\n        var element = (_this.element = document.createElement('div'));\n        element.classList.add('ag-chart-wrapper');\n        element.style.position = 'relative';\n        _this.scene = new Scene({ document: document, overrideDevicePixelRatio: overrideDevicePixelRatio });\n        _this.scene.debug.consoleLog = _this._debug;\n        _this.scene.root = root;\n        _this.scene.container = element;\n        _this.autoSize = true;\n        SizeMonitor.observe(_this.element, function (size) {\n            var width = size.width, height = size.height;\n            if (!_this.autoSize) {\n                return;\n            }\n            if (width === 0 && height === 0) {\n                return;\n            }\n            if (width === _this.width && height === _this.height) {\n                return;\n            }\n            _this._lastAutoSize = [width, height];\n            _this.resize(width, height);\n        });\n        _this.tooltip = new Tooltip(function () { return _this.scene.canvas.element; }, document, function () { return _this.container; });\n        _this.setupDomListeners(_this.scene.canvas.element);\n        return _this;\n    }\n    Object.defineProperty(Chart.prototype, \"debug\", {\n        get: function () {\n            return this._debug;\n        },\n        set: function (value) {\n            this._debug = value;\n            this.scene.debug.consoleLog = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"container\", {\n        get: function () {\n            return this._container;\n        },\n        set: function (value) {\n            if (this._container !== value) {\n                var parentNode = this.element.parentNode;\n                if (parentNode != null) {\n                    parentNode.removeChild(this.element);\n                }\n                if (value && !this.destroyed) {\n                    value.appendChild(this.element);\n                }\n                this._container = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"data\", {\n        get: function () {\n            return this._data;\n        },\n        set: function (data) {\n            this._data = data;\n            this.series.forEach(function (series) { return (series.data = data); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"width\", {\n        get: function () {\n            return this.scene.width;\n        },\n        set: function (value) {\n            this.autoSize = false;\n            if (this.width !== value) {\n                this.resize(value, this.height);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"height\", {\n        get: function () {\n            return this.scene.height;\n        },\n        set: function (value) {\n            this.autoSize = false;\n            if (this.height !== value) {\n                this.resize(this.width, value);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"autoSize\", {\n        get: function () {\n            return this._autoSize;\n        },\n        set: function (value) {\n            if (this._autoSize === value) {\n                return;\n            }\n            this._autoSize = value;\n            var style = this.element.style;\n            if (value) {\n                style.display = 'block';\n                style.width = '100%';\n                style.height = '100%';\n                if (!this._lastAutoSize) {\n                    return;\n                }\n                this.resize(this._lastAutoSize[0], this._lastAutoSize[1]);\n            }\n            else {\n                style.display = 'inline-block';\n                style.width = 'auto';\n                style.height = 'auto';\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.download = function (fileName, fileFormat) {\n        this.scene.download(fileName, fileFormat);\n    };\n    Object.defineProperty(Chart.prototype, \"title\", {\n        get: function () {\n            return this._title;\n        },\n        set: function (caption) {\n            var _a, _b;\n            var root = this.scene.root;\n            if (this._title != null) {\n                (_a = root) === null || _a === void 0 ? void 0 : _a.removeChild(this._title.node);\n            }\n            this._title = caption;\n            if (this._title != null) {\n                (_b = root) === null || _b === void 0 ? void 0 : _b.appendChild(this._title.node);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"subtitle\", {\n        get: function () {\n            return this._subtitle;\n        },\n        set: function (caption) {\n            var _a, _b;\n            var root = this.scene.root;\n            if (this._subtitle != null) {\n                (_a = root) === null || _a === void 0 ? void 0 : _a.removeChild(this._subtitle.node);\n            }\n            this._subtitle = caption;\n            if (this._subtitle != null) {\n                (_b = root) === null || _b === void 0 ? void 0 : _b.appendChild(this._subtitle.node);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"destroyed\", {\n        get: function () {\n            return this._destroyed;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.destroy = function () {\n        this._performUpdateType = ChartUpdateType.NONE;\n        this._pendingFactoryUpdates.splice(0);\n        this.tooltip.destroy();\n        SizeMonitor.unobserve(this.element);\n        this.container = undefined;\n        this.cleanupDomListeners(this.scene.canvas.element);\n        this.scene.destroy();\n        this.series.forEach(function (s) { return s.destroy(); });\n        this.series = [];\n        this._destroyed = true;\n    };\n    Chart.prototype.log = function (opts) {\n        if (this.debug) {\n            console.log(opts);\n        }\n    };\n    Chart.prototype.togglePointer = function (visible) {\n        if (this.tooltip.enabled) {\n            this.tooltip.toggle(visible);\n        }\n        else if (this.lastPick) {\n            this.changeHighlightDatum();\n        }\n    };\n    Chart.prototype.requestFactoryUpdate = function (cb) {\n        var callbacks = this._pendingFactoryUpdates;\n        var count = callbacks.length;\n        if (count === 0) {\n            callbacks.push(cb);\n            this._processCallbacks();\n        }\n        else {\n            // Factory callback process already running, the callback will be invoked asynchronously.\n            // Clear the queue after the first callback to prevent unnecessary re-renderings.\n            callbacks.splice(1, count - 1, cb);\n        }\n    };\n    Chart.prototype._processCallbacks = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var callbacks, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        callbacks = this._pendingFactoryUpdates;\n                        _a.label = 1;\n                    case 1:\n                        if (!(callbacks.length > 0)) return [3 /*break*/, 7];\n                        if (!this.updatePending) return [3 /*break*/, 3];\n                        return [4 /*yield*/, sleep(1)];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 1]; // Make sure to check queue has an item before continuing.\n                    case 3:\n                        _a.trys.push([3, 5, , 6]);\n                        return [4 /*yield*/, callbacks[0]()];\n                    case 4:\n                        _a.sent();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        e_1 = _a.sent();\n                        console.error(e_1);\n                        return [3 /*break*/, 6];\n                    case 6:\n                        callbacks.shift();\n                        return [3 /*break*/, 1];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Object.defineProperty(Chart.prototype, \"performUpdateType\", {\n        get: function () {\n            return this._performUpdateType;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"updatePending\", {\n        get: function () {\n            return this._performUpdateType !== ChartUpdateType.NONE || this.lastPointerMeta != null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Chart.prototype, \"lastPerformUpdateError\", {\n        get: function () {\n            return this._lastPerformUpdateError;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.awaitUpdateCompletion = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.performUpdateTrigger.await()];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Chart.prototype.update = function (type, opts) {\n        var e_2, _a;\n        if (type === void 0) { type = ChartUpdateType.FULL; }\n        var _b = opts || {}, _c = _b.forceNodeDataRefresh, forceNodeDataRefresh = _c === void 0 ? false : _c, _d = _b.seriesToUpdate, seriesToUpdate = _d === void 0 ? this.series : _d;\n        if (forceNodeDataRefresh) {\n            this.series.forEach(function (series) { return series.markNodeDataDirty(); });\n        }\n        try {\n            for (var seriesToUpdate_1 = __values(seriesToUpdate), seriesToUpdate_1_1 = seriesToUpdate_1.next(); !seriesToUpdate_1_1.done; seriesToUpdate_1_1 = seriesToUpdate_1.next()) {\n                var series = seriesToUpdate_1_1.value;\n                this.seriesToUpdate.add(series);\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (seriesToUpdate_1_1 && !seriesToUpdate_1_1.done && (_a = seriesToUpdate_1.return)) _a.call(seriesToUpdate_1);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n        if (type < this._performUpdateType) {\n            this._performUpdateType = type;\n            this.performUpdateTrigger.schedule();\n        }\n    };\n    Chart.prototype.performUpdate = function (count) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, performUpdateType, extraDebugStats, splits, _b, count_1, seriesRect_1, seriesUpdates, end;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _a = this, performUpdateType = _a._performUpdateType, extraDebugStats = _a.extraDebugStats;\n                        splits = [performance.now()];\n                        _b = performUpdateType;\n                        switch (_b) {\n                            case ChartUpdateType.FULL: return [3 /*break*/, 1];\n                            case ChartUpdateType.PROCESS_DATA: return [3 /*break*/, 1];\n                            case ChartUpdateType.PERFORM_LAYOUT: return [3 /*break*/, 3];\n                            case ChartUpdateType.SERIES_UPDATE: return [3 /*break*/, 5];\n                            case ChartUpdateType.SCENE_RENDER: return [3 /*break*/, 7];\n                            case ChartUpdateType.NONE: return [3 /*break*/, 9];\n                        }\n                        return [3 /*break*/, 10];\n                    case 1: return [4 /*yield*/, this.processData()];\n                    case 2:\n                        _c.sent();\n                        splits.push(performance.now());\n                        // Disable tooltip/highlight if the data fundamentally shifted.\n                        this.disablePointer({ updateProcessing: false });\n                        _c.label = 3;\n                    case 3:\n                        if (this._autoSize && !this._lastAutoSize) {\n                            count_1 = this._performUpdateNoRenderCount++;\n                            if (count_1 < 5) {\n                                // Reschedule if canvas size hasn't been set yet to avoid a race.\n                                this._performUpdateType = ChartUpdateType.PERFORM_LAYOUT;\n                                this.performUpdateTrigger.schedule();\n                                return [3 /*break*/, 10];\n                            }\n                            // After several failed passes, continue and accept there maybe a redundant\n                            // render. Sometimes this case happens when we already have the correct\n                            // width/height, and we end up never rendering the chart in that scenario.\n                        }\n                        this._performUpdateNoRenderCount = 0;\n                        return [4 /*yield*/, this.performLayout()];\n                    case 4:\n                        _c.sent();\n                        splits.push(performance.now());\n                        _c.label = 5;\n                    case 5:\n                        seriesRect_1 = this.seriesRect;\n                        seriesUpdates = __spread(this.seriesToUpdate).map(function (series) { return series.update({ seriesRect: seriesRect_1 }); });\n                        this.seriesToUpdate.clear();\n                        return [4 /*yield*/, Promise.all(seriesUpdates)];\n                    case 6:\n                        _c.sent();\n                        splits.push(performance.now());\n                        _c.label = 7;\n                    case 7: return [4 /*yield*/, this.scene.render({ debugSplitTimes: splits, extraDebugStats: extraDebugStats })];\n                    case 8:\n                        _c.sent();\n                        this.extraDebugStats = {};\n                        _c.label = 9;\n                    case 9:\n                        // Do nothing.\n                        this._performUpdateType = ChartUpdateType.NONE;\n                        _c.label = 10;\n                    case 10:\n                        end = performance.now();\n                        this.log({\n                            chart: this,\n                            durationMs: Math.round((end - splits[0]) * 100) / 100,\n                            count: count,\n                            performUpdateType: ChartUpdateType[performUpdateType],\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Object.defineProperty(Chart.prototype, \"axes\", {\n        get: function () {\n            return this._axes;\n        },\n        set: function (values) {\n            var _this = this;\n            this._axes.forEach(function (axis) { return _this.detachAxis(axis); });\n            // make linked axes go after the regular ones (simulates stable sort by `linkedTo` property)\n            this._axes = values.filter(function (a) { return !a.linkedTo; }).concat(values.filter(function (a) { return a.linkedTo; }));\n            this._axes.forEach(function (axis) { return _this.attachAxis(axis); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.attachAxis = function (axis) {\n        this.scene.root.insertBefore(axis.gridlineGroup, this.seriesRoot);\n        this.scene.root.insertBefore(axis.axisGroup, this.seriesRoot);\n        this.scene.root.insertBefore(axis.crossLineGroup, this.seriesRoot);\n    };\n    Chart.prototype.detachAxis = function (axis) {\n        this.scene.root.removeChild(axis.axisGroup);\n        this.scene.root.removeChild(axis.gridlineGroup);\n        this.scene.root.removeChild(axis.crossLineGroup);\n    };\n    Object.defineProperty(Chart.prototype, \"series\", {\n        get: function () {\n            return this._series;\n        },\n        set: function (values) {\n            var _this = this;\n            this.removeAllSeries();\n            values.forEach(function (series) { return _this.addSeries(series); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Chart.prototype.addSeries = function (series, before) {\n        var _a = this, allSeries = _a.series, seriesRoot = _a.seriesRoot;\n        var canAdd = allSeries.indexOf(series) < 0;\n        if (canAdd) {\n            var beforeIndex = before ? allSeries.indexOf(before) : -1;\n            if (beforeIndex >= 0) {\n                allSeries.splice(beforeIndex, 0, series);\n                seriesRoot.insertBefore(series.group, before.group);\n            }\n            else {\n                allSeries.push(series);\n                seriesRoot.append(series.group);\n            }\n            this.initSeries(series);\n            return true;\n        }\n        return false;\n    };\n    Chart.prototype.initSeries = function (series) {\n        series.chart = this;\n        if (!series.data) {\n            series.data = this.data;\n        }\n        series.addEventListener('nodeClick', this.onSeriesNodeClick, this);\n    };\n    Chart.prototype.freeSeries = function (series) {\n        series.chart = undefined;\n        series.removeEventListener('nodeClick', this.onSeriesNodeClick, this);\n    };\n    Chart.prototype.addSeriesAfter = function (series, after) {\n        var _a = this, allSeries = _a.series, seriesRoot = _a.seriesRoot;\n        var canAdd = allSeries.indexOf(series) < 0;\n        if (canAdd) {\n            var afterIndex = after ? this.series.indexOf(after) : -1;\n            if (afterIndex >= 0) {\n                if (afterIndex + 1 < allSeries.length) {\n                    seriesRoot.insertBefore(series.group, allSeries[afterIndex + 1].group);\n                }\n                else {\n                    seriesRoot.append(series.group);\n                }\n                this.initSeries(series);\n                allSeries.splice(afterIndex + 1, 0, series);\n            }\n            else {\n                if (allSeries.length > 0) {\n                    seriesRoot.insertBefore(series.group, allSeries[0].group);\n                }\n                else {\n                    seriesRoot.append(series.group);\n                }\n                this.initSeries(series);\n                allSeries.unshift(series);\n            }\n        }\n        return false;\n    };\n    Chart.prototype.removeSeries = function (series) {\n        var index = this.series.indexOf(series);\n        if (index >= 0) {\n            this.series.splice(index, 1);\n            this.freeSeries(series);\n            this.seriesRoot.removeChild(series.group);\n            return true;\n        }\n        return false;\n    };\n    Chart.prototype.removeAllSeries = function () {\n        var _this = this;\n        this.series.forEach(function (series) {\n            _this.freeSeries(series);\n            _this.seriesRoot.removeChild(series.group);\n        });\n        this._series = []; // using `_series` instead of `series` to prevent infinite recursion\n    };\n    Chart.prototype.assignSeriesToAxes = function () {\n        var _this = this;\n        this.axes.forEach(function (axis) {\n            axis.boundSeries = _this.series.filter(function (s) {\n                var seriesAxis = axis.direction === ChartAxisDirection.X ? s.xAxis : s.yAxis;\n                return seriesAxis === axis;\n            });\n        });\n    };\n    Chart.prototype.assignAxesToSeries = function (force) {\n        var _this = this;\n        if (force === void 0) { force = false; }\n        // This method has to run before `assignSeriesToAxes`.\n        var directionToAxesMap = {};\n        this.axes.forEach(function (axis) {\n            var direction = axis.direction;\n            var directionAxes = directionToAxesMap[direction] || (directionToAxesMap[direction] = []);\n            directionAxes.push(axis);\n        });\n        this.series.forEach(function (series) {\n            series.directions.forEach(function (direction) {\n                var currentAxis = direction === ChartAxisDirection.X ? series.xAxis : series.yAxis;\n                if (currentAxis && !force) {\n                    return;\n                }\n                var directionAxes = directionToAxesMap[direction];\n                if (!directionAxes) {\n                    console.warn(\"AG Charts - no available axis for direction [\" + direction + \"]; check series and axes configuration.\");\n                    return;\n                }\n                var seriesKeys = series.getKeys(direction);\n                var newAxis = _this.findMatchingAxis(directionAxes, series.getKeys(direction));\n                if (!newAxis) {\n                    console.warn(\"AG Charts - no matching axis for direction [\" + direction + \"] and keys [\" + seriesKeys + \"]; check series and axes configuration.\");\n                    return;\n                }\n                if (direction === ChartAxisDirection.X) {\n                    series.xAxis = newAxis;\n                }\n                else {\n                    series.yAxis = newAxis;\n                }\n            });\n        });\n    };\n    Chart.prototype.findMatchingAxis = function (directionAxes, directionKeys) {\n        var e_3, _a, e_4, _b;\n        try {\n            for (var directionAxes_1 = __values(directionAxes), directionAxes_1_1 = directionAxes_1.next(); !directionAxes_1_1.done; directionAxes_1_1 = directionAxes_1.next()) {\n                var axis = directionAxes_1_1.value;\n                var axisKeys = axis.keys;\n                if (!axisKeys.length) {\n                    return axis;\n                }\n                if (!directionKeys) {\n                    continue;\n                }\n                try {\n                    for (var directionKeys_1 = (e_4 = void 0, __values(directionKeys)), directionKeys_1_1 = directionKeys_1.next(); !directionKeys_1_1.done; directionKeys_1_1 = directionKeys_1.next()) {\n                        var directionKey = directionKeys_1_1.value;\n                        if (axisKeys.indexOf(directionKey) >= 0) {\n                            return axis;\n                        }\n                    }\n                }\n                catch (e_4_1) { e_4 = { error: e_4_1 }; }\n                finally {\n                    try {\n                        if (directionKeys_1_1 && !directionKeys_1_1.done && (_b = directionKeys_1.return)) _b.call(directionKeys_1);\n                    }\n                    finally { if (e_4) throw e_4.error; }\n                }\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (directionAxes_1_1 && !directionAxes_1_1.done && (_a = directionAxes_1.return)) _a.call(directionAxes_1);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n    };\n    Chart.prototype.resize = function (width, height) {\n        if (this.scene.resize(width, height)) {\n            this.background.width = this.width;\n            this.background.height = this.height;\n            this.update(ChartUpdateType.PERFORM_LAYOUT, { forceNodeDataRefresh: true });\n        }\n    };\n    Chart.prototype.processData = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.axes.length > 0 || this.series.some(function (s) { return s instanceof CartesianSeries; })) {\n                            this.assignAxesToSeries(true);\n                            this.assignSeriesToAxes();\n                        }\n                        return [4 /*yield*/, Promise.all(this.series.map(function (s) { return s.processData(); }))];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.updateLegend()];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Chart.prototype.placeLabels = function () {\n        var e_5, _a;\n        var visibleSeries = [];\n        var data = [];\n        try {\n            for (var _b = __values(this.series), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var series = _c.value;\n                if (!series.visible) {\n                    continue;\n                }\n                var labelData = series.getLabelData();\n                if (!(labelData && isPointLabelDatum(labelData[0]))) {\n                    continue;\n                }\n                data.push(labelData);\n                visibleSeries.push(series);\n            }\n        }\n        catch (e_5_1) { e_5 = { error: e_5_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_5) throw e_5.error; }\n        }\n        var seriesRect = this.seriesRect;\n        var labels = seriesRect && data.length > 0\n            ? placeLabels(data, { x: 0, y: 0, width: seriesRect.width, height: seriesRect.height })\n            : [];\n        return new Map(labels.map(function (l, i) { return [visibleSeries[i], l]; }));\n    };\n    Chart.prototype.updateLegend = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var legendData, formatter;\n            return __generator(this, function (_a) {\n                legendData = [];\n                this.series\n                    .filter(function (s) { return s.showInLegend; })\n                    .forEach(function (series) {\n                    legendData.push.apply(legendData, __spread(series.getLegendData()));\n                });\n                formatter = this.legend.item.label.formatter;\n                if (formatter) {\n                    legendData.forEach(function (datum) {\n                        return (datum.label.text = formatter({\n                            get id() {\n                                doOnce(function () {\n                                    return console.warn(\"AG Charts - LegendLabelFormatterParams.id is deprecated, use seriesId instead\", datum);\n                                }, \"LegendLabelFormatterParams.id deprecated\");\n                                return datum.seriesId;\n                            },\n                            itemId: datum.itemId,\n                            value: datum.label.text,\n                            seriesId: datum.seriesId,\n                        }));\n                    });\n                }\n                this.legend.data = legendData;\n                return [2 /*return*/];\n            });\n        });\n    };\n    Chart.prototype.positionCaptions = function () {\n        var _a = this, title = _a._title, subtitle = _a._subtitle;\n        var spacing = 10;\n        var paddingTop = spacing;\n        if (!title) {\n            return {};\n        }\n        title.node.visible = title.enabled;\n        if (title.enabled) {\n            title.node.x = this.width / 2;\n            title.node.y = paddingTop;\n            var titleBBox = title.node.computeBBox(); // make sure to set node's x/y, then computeBBox\n            if (titleBBox) {\n                paddingTop = titleBBox.y + titleBBox.height;\n            }\n        }\n        if (!subtitle) {\n            return {};\n        }\n        subtitle.node.visible = title.enabled && subtitle.enabled;\n        if (title.enabled && subtitle.enabled) {\n            subtitle.node.x = this.width / 2;\n            subtitle.node.y = paddingTop + spacing;\n            var subtitleBBox = subtitle.node.computeBBox();\n            if (subtitleBBox) {\n                paddingTop = subtitleBBox.y + subtitleBBox.height;\n            }\n        }\n        return { captionAutoPadding: Math.floor(paddingTop) };\n    };\n    Chart.prototype.positionLegend = function (captionAutoPadding) {\n        var _a = this, legend = _a.legend, legendAutoPadding = _a.legendAutoPadding;\n        legendAutoPadding.clear();\n        if (!legend.enabled || !legend.data.length) {\n            return;\n        }\n        var width = this.width;\n        var height = this.height - captionAutoPadding;\n        var legendGroup = legend.group;\n        var legendSpacing = legend.spacing;\n        var translationX = 0;\n        var translationY = 0;\n        var legendBBox;\n        switch (legend.position) {\n            case 'bottom':\n                legend.performLayout(width - legendSpacing * 2, 0);\n                legendBBox = legendGroup.computeBBox();\n                legendGroup.visible = legendBBox.height < Math.floor(height * 0.5); // Remove legend if it takes up more than 50% of the chart height.\n                if (legendGroup.visible) {\n                    translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n                    translationY = captionAutoPadding + height - legendBBox.height - legendBBox.y - legendSpacing;\n                    legendAutoPadding.bottom = legendBBox.height;\n                }\n                else {\n                    legendAutoPadding.bottom = 0;\n                }\n                break;\n            case 'top':\n                legend.performLayout(width - legendSpacing * 2, 0);\n                legendBBox = legendGroup.computeBBox();\n                legendGroup.visible = legendBBox.height < Math.floor(height * 0.5);\n                if (legendGroup.visible) {\n                    translationX = (width - legendBBox.width) / 2 - legendBBox.x;\n                    translationY = captionAutoPadding + legendSpacing - legendBBox.y;\n                    legendAutoPadding.top = legendBBox.height;\n                }\n                else {\n                    legendAutoPadding.top = 0;\n                }\n                break;\n            case 'left':\n                legend.performLayout(width, height - legendSpacing * 2);\n                legendBBox = legendGroup.computeBBox();\n                legendGroup.visible = legendBBox.width < Math.floor(width * 0.5); // Remove legend if it takes up more than 50% of the chart width.\n                if (legendGroup.visible) {\n                    translationX = legendSpacing - legendBBox.x;\n                    translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n                    legendAutoPadding.left = legendBBox.width;\n                }\n                else {\n                    legendAutoPadding.left = 0;\n                }\n                break;\n            default: // case 'right':\n                legend.performLayout(width, height - legendSpacing * 2);\n                legendBBox = legendGroup.computeBBox();\n                legendGroup.visible = legendBBox.width < Math.floor(width * 0.5);\n                if (legendGroup.visible) {\n                    translationX = width - legendBBox.width - legendBBox.x - legendSpacing;\n                    translationY = captionAutoPadding + (height - legendBBox.height) / 2 - legendBBox.y;\n                    legendAutoPadding.right = legendBBox.width;\n                }\n                else {\n                    legendAutoPadding.right = 0;\n                }\n                break;\n        }\n        if (legendGroup.visible) {\n            // Round off for pixel grid alignment to work properly.\n            legendGroup.translationX = Math.floor(translationX + legendGroup.translationX);\n            legendGroup.translationY = Math.floor(translationY + legendGroup.translationY);\n            this.legendBBox = legendGroup.computeBBox();\n        }\n    };\n    Chart.prototype.setupDomListeners = function (chartElement) {\n        chartElement.addEventListener('mousedown', this._onMouseDown);\n        chartElement.addEventListener('mousemove', this._onMouseMove);\n        chartElement.addEventListener('mouseup', this._onMouseUp);\n        chartElement.addEventListener('mouseout', this._onMouseOut);\n        chartElement.addEventListener('click', this._onClick);\n    };\n    Chart.prototype.cleanupDomListeners = function (chartElement) {\n        chartElement.removeEventListener('mousedown', this._onMouseDown);\n        chartElement.removeEventListener('mousemove', this._onMouseMove);\n        chartElement.removeEventListener('mouseup', this._onMouseUp);\n        chartElement.removeEventListener('mouseout', this._onMouseOut);\n        chartElement.removeEventListener('click', this._onClick);\n    };\n    Chart.prototype.getSeriesRect = function () {\n        return this.seriesRect;\n    };\n    // x/y are local canvas coordinates in CSS pixels, not actual pixels\n    Chart.prototype.pickSeriesNode = function (point) {\n        var e_6, _a;\n        var _b, _c;\n        var tracking = this.tooltip.tracking;\n        var start = performance.now();\n        // Disable 'nearest match' options if tooltip.tracking is enabled.\n        var pickModes = tracking ? undefined : [SeriesNodePickMode.EXACT_SHAPE_MATCH];\n        // Iterate through series in reverse, as later declared series appears on top of earlier\n        // declared series.\n        var reverseSeries = __spread(this.series).reverse();\n        var result = undefined;\n        try {\n            for (var reverseSeries_1 = __values(reverseSeries), reverseSeries_1_1 = reverseSeries_1.next(); !reverseSeries_1_1.done; reverseSeries_1_1 = reverseSeries_1.next()) {\n                var series = reverseSeries_1_1.value;\n                if (!series.visible || !series.group.visible) {\n                    continue;\n                }\n                var _d = (_b = series.pickNode(point, pickModes), (_b !== null && _b !== void 0 ? _b : {})), match = _d.match, distance = _d.distance;\n                if (!match || distance == null) {\n                    continue;\n                }\n                if (!result || result.distance > distance) {\n                    result = { series: series, distance: distance, datum: match };\n                }\n                if (distance === 0) {\n                    break;\n                }\n            }\n        }\n        catch (e_6_1) { e_6 = { error: e_6_1 }; }\n        finally {\n            try {\n                if (reverseSeries_1_1 && !reverseSeries_1_1.done && (_a = reverseSeries_1.return)) _a.call(reverseSeries_1);\n            }\n            finally { if (e_6) throw e_6.error; }\n        }\n        this.extraDebugStats['pickSeriesNode'] = Math.round((_c = this.extraDebugStats['pickSeriesNode'], (_c !== null && _c !== void 0 ? _c : 0)) + (performance.now() - start));\n        return result;\n    };\n    Chart.prototype.onMouseMove = function (event) {\n        this.handleLegendMouseMove(event);\n        if (this.tooltip.enabled) {\n            if (this.tooltip.delay > 0) {\n                this.togglePointer(false);\n            }\n        }\n        this.lastPointerMeta = {\n            pageX: event.pageX,\n            pageY: event.pageY,\n            offsetX: event.offsetX,\n            offsetY: event.offsetY,\n            event: event,\n        };\n        this.pointerScheduler.schedule();\n        this.extraDebugStats['mouseX'] = event.offsetX;\n        this.extraDebugStats['mouseY'] = event.offsetY;\n        this.update(ChartUpdateType.SCENE_RENDER);\n    };\n    Chart.prototype.disablePointer = function (_a) {\n        var _b = (_a === void 0 ? {} : _a).updateProcessing, updateProcessing = _b === void 0 ? true : _b;\n        this.changeHighlightDatum(undefined, { updateProcessing: updateProcessing });\n        this.togglePointer(false);\n    };\n    Chart.prototype.handlePointer = function (meta) {\n        var _this = this;\n        var lastPick = this.lastPick;\n        var offsetX = meta.offsetX, offsetY = meta.offsetY;\n        var disablePointer = function () {\n            if (lastPick) {\n                // Cursor moved from a non-marker node to empty space.\n                _this.disablePointer();\n            }\n        };\n        if (!(this.seriesRect && this.seriesRect.containsPoint(offsetX, offsetY))) {\n            disablePointer();\n            return;\n        }\n        var pick = this.pickSeriesNode({ x: offsetX, y: offsetY });\n        if (!pick) {\n            disablePointer();\n            return;\n        }\n        if (!lastPick || lastPick.datum !== pick.datum) {\n            this.onSeriesDatumPick(meta, pick.datum);\n            return;\n        }\n        lastPick.event = meta.event;\n        if (this.tooltip.enabled && pick.series.tooltip.enabled) {\n            this.tooltip.show(this.mergePointerDatum(meta, pick.datum));\n        }\n    };\n    Chart.prototype.onMouseDown = function (_event) {\n        // Override point for subclasses.\n    };\n    Chart.prototype.onMouseUp = function (_event) {\n        // Override point for subclasses.\n    };\n    Chart.prototype.onMouseOut = function (_event) {\n        this.togglePointer(false);\n    };\n    Chart.prototype.onClick = function (event) {\n        if (this.checkSeriesNodeClick()) {\n            this.update(ChartUpdateType.SERIES_UPDATE);\n            return;\n        }\n        if (this.checkLegendClick(event)) {\n            this.update(ChartUpdateType.PROCESS_DATA, { forceNodeDataRefresh: true });\n            return;\n        }\n        this.fireEvent({\n            type: 'click',\n            event: event,\n        });\n    };\n    Chart.prototype.checkSeriesNodeClick = function () {\n        var lastPick = this.lastPick;\n        if (lastPick && lastPick.event) {\n            var event_1 = lastPick.event, datum = lastPick.datum;\n            datum.series.fireNodeClickEvent(event_1, datum);\n            return true;\n        }\n        return false;\n    };\n    Chart.prototype.onSeriesNodeClick = function (event) {\n        var seriesNodeClickEvent = __assign(__assign({}, event), { type: 'seriesNodeClick' });\n        Object.defineProperty(seriesNodeClickEvent, 'series', {\n            enumerable: false,\n            // Should display the deprecation warning\n            get: function () { return event.series; },\n        });\n        this.fireEvent(seriesNodeClickEvent);\n    };\n    Chart.prototype.checkLegendClick = function (event) {\n        var _a;\n        var _b = this, legend = _b.legend, legendItemClick = _b.legend.listeners.legendItemClick;\n        var datum = legend.getDatumForPoint(event.offsetX, event.offsetY);\n        if (!datum) {\n            return false;\n        }\n        var id = datum.id, itemId = datum.itemId, enabled = datum.enabled;\n        var series = find(this.series, function (s) { return s.id === id; });\n        if (!series) {\n            return false;\n        }\n        series.toggleSeriesItem(itemId, !enabled);\n        if (enabled) {\n            this.togglePointer(false);\n        }\n        if (enabled && ((_a = this.highlightedDatum) === null || _a === void 0 ? void 0 : _a.series) === series) {\n            this.highlightedDatum = undefined;\n        }\n        if (!enabled) {\n            this.highlightedDatum = {\n                series: series,\n                itemId: itemId,\n                datum: undefined,\n            };\n        }\n        legendItemClick({ enabled: !enabled, itemId: itemId, seriesId: series.id });\n        return true;\n    };\n    Chart.prototype.handleLegendMouseMove = function (event) {\n        if (!this.legend.enabled) {\n            return;\n        }\n        var offsetX = event.offsetX, offsetY = event.offsetY;\n        var datum = this.legend.getDatumForPoint(offsetX, offsetY);\n        var pointerInsideLegend = this.legendBBox.containsPoint(offsetX, offsetY);\n        var pointerOverLegendDatum = pointerInsideLegend && datum !== undefined;\n        if (!pointerInsideLegend && this.pointerInsideLegend) {\n            this.pointerInsideLegend = false;\n            this.element.style.cursor = 'default';\n            // Dehighlight if the pointer was inside the legend and is now leaving it.\n            this.changeHighlightDatum();\n            return;\n        }\n        if (pointerOverLegendDatum && !this.pointerOverLegendDatum) {\n            this.element.style.cursor = 'pointer';\n            if (datum && this.legend.truncatedItems.has(datum.itemId || datum.id)) {\n                this.element.title = datum.label.text;\n            }\n            else {\n                this.element.title = '';\n            }\n        }\n        if (!pointerOverLegendDatum && this.pointerOverLegendDatum) {\n            this.element.style.cursor = 'default';\n        }\n        this.pointerInsideLegend = pointerInsideLegend;\n        this.pointerOverLegendDatum = pointerOverLegendDatum;\n        var oldHighlightedDatum = this.highlightedDatum;\n        if (datum) {\n            var id_1 = datum.id, itemId = datum.itemId, enabled = datum.enabled;\n            if (enabled) {\n                var series = find(this.series, function (series) { return series.id === id_1; });\n                if (series) {\n                    this.highlightedDatum = {\n                        series: series,\n                        itemId: itemId,\n                        datum: undefined,\n                    };\n                }\n            }\n            else {\n                this.highlightedDatum = undefined;\n            }\n        }\n        // Careful to only schedule updates when necessary.\n        if ((this.highlightedDatum && !oldHighlightedDatum) ||\n            (!this.highlightedDatum && oldHighlightedDatum) ||\n            (this.highlightedDatum &&\n                oldHighlightedDatum &&\n                (this.highlightedDatum.series !== oldHighlightedDatum.series ||\n                    this.highlightedDatum.itemId !== oldHighlightedDatum.itemId))) {\n            this.update(ChartUpdateType.SERIES_UPDATE);\n        }\n    };\n    Chart.prototype.onSeriesDatumPick = function (meta, datum) {\n        var lastPick = this.lastPick;\n        if (lastPick) {\n            if (lastPick.datum === datum) {\n                return;\n            }\n        }\n        this.changeHighlightDatum({\n            datum: datum,\n            event: meta.event,\n        });\n        if (datum) {\n            meta = this.mergePointerDatum(meta, datum);\n        }\n        var tooltipEnabled = this.tooltip.enabled && datum.series.tooltip.enabled;\n        var html = tooltipEnabled && datum.series.getTooltipHtml(datum);\n        if (html) {\n            this.tooltip.show(meta, html);\n        }\n    };\n    Chart.prototype.mergePointerDatum = function (meta, datum) {\n        if (datum.point) {\n            var _a = datum.point, x = _a.x, y = _a.y;\n            var canvas = this.scene.canvas;\n            var point = datum.series.group.inverseTransformPoint(x, y);\n            var canvasRect = canvas.element.getBoundingClientRect();\n            return __assign(__assign({}, meta), { pageX: Math.round(canvasRect.left + window.scrollX + point.x), pageY: Math.round(canvasRect.top + window.scrollY + point.y), offsetX: Math.round(canvasRect.left + point.y), offsetY: Math.round(canvasRect.top + point.y) });\n        }\n        return meta;\n    };\n    Chart.prototype.changeHighlightDatum = function (newPick, opts) {\n        var _a = (opts !== null && opts !== void 0 ? opts : {}).updateProcessing, updateProcessing = _a === void 0 ? true : _a;\n        var seriesToUpdate = new Set();\n        var _b = newPick || {}, _c = _b.datum, _d = (_c === void 0 ? {} : _c).series, newSeries = _d === void 0 ? undefined : _d, _e = _b.datum, datum = _e === void 0 ? undefined : _e;\n        var _f = this.lastPick, _g = (_f === void 0 ? {} : _f).datum, _h = (_g === void 0 ? {} : _g).series, lastSeries = _h === void 0 ? undefined : _h;\n        if (lastSeries) {\n            seriesToUpdate.add(lastSeries);\n        }\n        if (newSeries) {\n            seriesToUpdate.add(newSeries);\n            this.element.style.cursor = newSeries.cursor;\n        }\n        this.lastPick = newPick;\n        this.highlightedDatum = datum;\n        if (!updateProcessing) {\n            return;\n        }\n        var updateAll = newSeries == null || lastSeries == null;\n        if (updateAll) {\n            this.update(ChartUpdateType.SERIES_UPDATE);\n        }\n        else {\n            this.update(ChartUpdateType.SERIES_UPDATE, { seriesToUpdate: seriesToUpdate });\n        }\n    };\n    Chart.prototype.waitForUpdate = function (timeoutMs) {\n        if (timeoutMs === void 0) { timeoutMs = 5000; }\n        return __awaiter(this, void 0, void 0, function () {\n            var start;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        start = performance.now();\n                        _a.label = 1;\n                    case 1:\n                        if (!(this._pendingFactoryUpdates.length > 0 || this.updatePending)) return [3 /*break*/, 3];\n                        if (performance.now() - start > timeoutMs) {\n                            throw new Error('waitForUpdate() timeout reached.');\n                        }\n                        return [4 /*yield*/, sleep(5)];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 1];\n                    case 3: return [4 /*yield*/, this.awaitUpdateCompletion()];\n                    case 4:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    __decorate([\n        Validate(BOOLEAN)\n    ], Chart.prototype, \"_autoSize\", void 0);\n    return Chart;\n}(Observable));\nexport { Chart };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}